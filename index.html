<!doctype html>
<?php
	$domainName = "CompressJPGOnline.com";
	$domainURL = "http://compressjpgonline.com";
	$icon_loc = "./img/icon.png";
	$main_title = "Compress JPG / JPEG Images Online for Free";  // Title of the Site
	
	$contact_email = "webbeastyt@gmail.com,";
?>
<?php include("https://raw.githubusercontent.com/lnn1053/Compressjpeg/main/brand.php"); ?>
<style>
.button {
	position:absolute;
    bottom:10px;
    right:10px;
}

#img_container {
    position:relative;
    display:inline-block;
    text-align:center;
}
</style>

<?php
	function randomHex() {
		return str_pad(dechex(rand(0x000000, 0xFFFFFF)), 6, 0, STR_PAD_LEFT);
	}  
	
	function uploadAndCompress($compression=60) {		//Default compression is 60%
		$randomFileName = randomHex();
		$tempJpgFileName = $randomFileName.".jpg";
		$upload_dir = "images/";
		$compressed_dir = "compressed_images/";
		$target_file = $upload_dir . $tempJpgFileName;
		$uploadOk = 1;
		$imageFileType = "";
		// Check if image file is a actual image or fake image
		if(isset($_POST["submit"])) {
		  $check = getimagesize($_FILES["fileToUpload"]["tmp_name"]);
		  $imageFileType = pathinfo($_FILES["fileToUpload"]["name"], PATHINFO_EXTENSION);
		  if($check !== false) {
			//echo "File is an image - " . $check["mime"] . ".";
			$uploadOk = 1;
		  } else {
			echo "File is not an image.";
			$uploadOk = 0;
		  }
		}

		// Check if file already exists
		if (file_exists($target_file)) {
		  echo "Sorry, file already exists.";
		  $uploadOk = 0;
		}

		// Check file size
		if ($_FILES["fileToUpload"]["size"] > 50000000) {       // 50 MB Maximum File size is allowed
		  echo "Sorry, your file is too large.";
		  $uploadOk = 0;
		}

		// Allow certain file formats
		if($imageFileType == "jpg" ||  $imageFileType == "jpeg") {
			$uploadOk = 1;
		} else {
		  echo "Sorry, only JPG / JPEG Format is allowed.";
		  $uploadOk = 0;
		}

		// Check if $uploadOk is set to 0 by an error
		if ($uploadOk == 0) {
		  echo " Sorry, your file was not uploaded.";
		// if everything is ok, try to upload file
		} else {
		  if (move_uploaded_file($_FILES["fileToUpload"]["tmp_name"], $target_file)) {
			//echo "The file ". htmlspecialchars( basename( $_FILES["fileToUpload"]["name"])). " has been uploaded.";
				$filePath = "./images/".htmlspecialchars($tempJpgFileName);
				$compressedFilePath = "./compressed_images/".$tempJpgFileName;
				
				compress($filePath, $compressedFilePath, $compression);
				
				echo "<div><h3>Preview</h3></div>";
				echo "
						<table style='border-collapse: collapse; margin: 10px auto; text-align: center;'>
							<tbody>
							<tr>
								<th>Original File</th>
								<th>Compressed File</th>
							</tr>
							<tr>
								<td><img src='".$filePath."' style='width:300px; margin: 0 auto;' class='img-thumbnail'/></td>
								<td><div id='img_container'><img src='".$compressedFilePath."' style='width:300px; margin: 0 auto;' class='img-thumbnail'/><a href='".$compressedFilePath."' class='button btn btn-success' role='button' download>Download Image</a></div></td>
							</tr>
							<tr>
								<td><span>".round(filesize($filePath) / 1024, 2)." KB</span></td>
								<td><span>".round(filesize($compressedFilePath) / 1024, 2)." KB</span> (<b>".round((filesize($filePath)-filesize($compressedFilePath))*100/filesize($filePath), 0)."% Size Reduced</b>)</td>
							</tr>
							</tbody>
						</table>
				";

			
		  } else {
			echo "Sorry, there was an error uploading your file.";
		  }

		}
	}
	
	function compress($src_file_loc, $dest_file_loc, $compression = 60) {
		$img = imagecreatefromjpeg($src_file_loc);
		imagejpeg($img, $dest_file_loc, $compression);
	}
	
	function src_file_loc($filename) {
		return "./images/".htmlspecialchars($filename);
	}
	function compressed_file_loc($filename) {
		return "./compressed_images/".$filename;
	}
?>
<?php include("https://raw.githubusercontent.com/lnn1053/Compressjpeg/main/helper.php"); ?>

	<?php include("https://raw.githubusercontent.com/lnn1053/Compressjpeg/main/head.php"); ?>
	<?php echo $main_title; ?>
	
	
	
</?php></?php></?php>

<?php include("https://raw.githubusercontent.com/lnn1053/Compressjpeg/main/header.php"); ?>

<div class="container">
	
	<div class="row">
		<p>This is a Free Online Tool to Compress JPEG Images to lowers file sizes.</p>
	</div>
	
	<div class='row' style='border: 1px solid #CCC; margin: 10px; padding: 10px; box-shadow: 2px 2px 0px 0px #CCC; border-radius: 10px; overflow: hidden;'>	
		<div style='text-align: center; margin: 10px;'>
			<?php
				if(isset($_post['submit'])) {
						uploadandcompress(100-$_post['compression_percentage']);
				}
			?>
		</?php
></div>

		<div class="row" style='text-align: center; border: 1px dashed #CCC; padding: 20px; max-width: 1200px; margin: 20px auto; border-radius: 10px;'>
			<form action="" method="post" enctype="multipart/form-data">
				<table style='border-collapse: collapse; margin: 10px auto; text-align: center;'>
				<tbody>
				<tr>
					<input type="file" class="form-control-file" name="fileToUpload" id="fileToUpload" required />
					<input class="btn btn-primary" type="submit" value="Compress Image" name="submit" style='margin: 10px;' />
					<input type="range" value="60" min="0" max="100" oninput="document.getElementById(&#39;output&#39;).value = this.value" name="compression_percentage" />
					<span style='color: #777; font-size: 12px;'><output id='output'> 60</output>% Compression</span>
				</tr>
				</tbody>
				</table>
			</form>
		</div>
	</div>
	
	<hr />
	
	<div class="row">
		<img src='https://github.com/lnn1053/Compressjpeg/blob/main/Img/main_page.png' style="max-width: 750px; margin-bottom: 20px;" class="rounded mx-auto d-block" alt="" />
		<h2 class='display-6'>How to convert PNG to JPG</h2>
		<p>
			<ol>
				<li>Upload any PNG format image you want to convert into JPG.</li>
				<li>Click on Upload Image and the Uploading will start.</li>
				<li>The PNG format image will automatically convert to JPG format and a JPG format image download link will be provided.</li>
				<li>Click on "Download Image in JPG" to download your converted image for free.</li>
			</ol>
		</p>
		
		
		<h2 class='display-6'>How can I convert PNG to JPG for free?</h2>
		<p>
			<ol>
				<li>Upload any PNG format image you want to convert into JPG.</li>
				<li>Click on Upload Image and the Uploading will start.</li>
				<li>The PNG format image will automatically convert to JPG format and a JPG format image download link will be provided.</li>
				<li>Click on "Download Image in JPG" to download your converted image for free.</li>
			</ol>
		</p>
	</div>
</div>
	
<?php include("https://raw.githubusercontent.com/lnn1053/Compressjpeg/main/footer.php"); ?>




</?php></?php>
</?php></!doctype>
